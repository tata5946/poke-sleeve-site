<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ポケカスリーブ価格推移</title>
  <style>
    body { font-family: sans-serif; margin: 40px; }
    h1 { margin-bottom: 10px; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 14px; padding:0; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 14px; }
    .title { font-weight: 800; font-size: 16px; margin-bottom: 6px; }
    .meta { font-size: 13px; color: #666; }
    a.btn { display:inline-block; margin-top: 10px; text-decoration:none; border:1px solid #333; padding:8px 10px; border-radius:8px; color:#111; }
  </style>
</head>
<body>
  <h1>ポケカスリーブ価格推移</h1>
  <input type="text" id="search" placeholder="スリーブ名で検索..." style="padding:8px; width:300px; margin-bottom:20px;">
  <p>データ（data.json）を更新すると一覧が自動で増えます。</p>

  <div id="list" class="grid"></div>

 <script>
async function main() {
  const res = await fetch("./data.json");
  const data = await res.json();

  const list = document.getElementById("list");
  const searchInput = document.getElementById("search");

  function render(keyword = "") {
    list.innerHTML = "";

    for (const s of data.sleeves) {
      if (!s.name.toLowerCase().includes(keyword.toLowerCase())) continue;

      const div = document.createElement("div");
      div.className = "card";

      div.innerHTML = `
        <div class="title">${escapeHtml(s.name)}</div>
        <div class="meta">発売年：${s.releaseYear} / ${escapeHtml(s.condition)} / ${escapeHtml(s.series)}</div>
        <a class="btn" href="./detail.html?id=${encodeURIComponent(s.id)}">価格推移を見る →</a>
      `;
      list.appendChild(div);
    }
  }

  render();

  searchInput.addEventListener("input", () => {
    render(searchInput.value);
  });
}

function escapeHtml(str) {
  return String(str)
    .replaceAll("&", "&amp;")
    .replaceAll("<", "&lt;")
    .replaceAll(">", "&gt;")
    .replaceAll('"', "&quot;")
    .replaceAll("'", "&#039;");
}

main();
</script>

</body>
</html>
